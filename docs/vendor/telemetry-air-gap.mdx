# Collecting Telemetry for Air Gap Instances (Beta)

This topic describes telemetry for instances in air gap environments with no outbound internet access. This information in this topic applies to instances installed with Replicated KOTS.

:::note
Air gap telemetry is in beta. This features, requirements, and limitations of air gap telemetry are subject to change. To access this feature, submit a [feature request](https://vendor.replicated.com/support?requestType=feature&productArea=vendor&title=Custom+Metrics+Request). 
:::

## Overview

[EDIT ME]

With this new launch, any support bundles uploaded for any customer will contribute state and event history to the core dataset used for tactical and strategic insights across all your instances. You’ll be able to inspect airgapped instances with the same view as online instances.

This works by using new support bundle logic introduced in KOTS-SDK v1.100.0 and in KOTS v1.101.0 that packages event history in a support bundle. If this is something you’re interested in, we’d like to hear from you. Additional bundles can be uploaded periodically to hydrate additional data. Any overlaps in support bundle event archives are handled idempotently.

For more information about how to vendor portal collects data from online instances, see [About Instance and Event Data](/vendor/instance-insights-event-data#about-reporting).

In order to provide telemetry for these instances, Replicated will parse any support bundle uploaded looking for one of several events archive files. At time of writing, In this case, the Replicated SDK running in the customer environment will maintain a rolling log of recent events in a Kubernetes Secret, using the same state / change detection logic that has powered the Instance Telemetry feature for over a year now:

From there, a support bundle can be collected from either the support-bundle CLI or from the KOTS Admin console. In either case, that secret will be included in the support bundle, along with all the normal K8s statuses, application pod logs, etc:

From there, the sdk-events file will be processed by the replicated backend upon upload by the vendor:

## Collect and View Air Gap Telemetry

1. Ensure that your application includes a support bundle spec. For more information, see __

1. Have your customer start by collecting a support bundle. This can be done from the kubectl support-bundle CLI, or from the KOTS admin console’s Troubleshoot tab. For more information, see ___

1. Upload the support bundle to the vendor portal.

    Once a bundle is uploaded, Replicated will detect the customer and instance ID based on the bundle contents, and populate data based on the events in the bundle, whether adding the new events to an existing instance or creating a new instance record.


1. Go to the instance insights page for the instance to view air gap telemetry.

## Requirements

* Requires KOTS v1.101.0 or later
* The support bundle must be generated by KOTS. Generic troubleshoot specs (which do not include instance data) are not supported
* KOTS must be running in air gapped mode to collect telemetry in the support bundle. 

## Limitations

Air gap telemetry has the following limtations:

* Air gap telemetry is in beta
* Air gap telemetry is supported only for instances installed with KOTS. Air gap telemetry is not supported for instances installed with the Helm CLI.
* Support bundles only include N days of data by default. To get more value from the event history powered by this feature, you may want to build a practice of collecting monthly or quarterly support bundles from your important airgapped customers.
