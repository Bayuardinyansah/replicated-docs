# Vulnerability Patch Policy

While it’s our goal to distribute vulnerability-free versions of all components, this isn’t always possible.
Kubernetes and KOTS are made from many components, each authored by different vendors.

The best way to stay ahead of vulnerabilities is to run the latest version and have a strategy to quickly update when a patch is available.

## How We Scan

Our build pipeline uses [Trivy](https://www.aquasec.com/products/trivy/) to scan for and detect known, published vulnerabilities in our images.
It’s possible that other security scanners will detect a different set of results.
We commit to patching vulnerabilities according to the timeline below based on the results of our internal scans.

If you or your customer detects a different vulnerability using a different scanner, we encourage you to report it to us in a GitHub issue, Slack message, or emailing support@replicated.com.
Our team will evaluate the vulnerability and determine the best course of action.

## Base Images

When possible, KOTS uses alpine, scratch, or distroless images to reduce the number of components that might be affected by CVEs.
When a larger base image is required, we will keep it updated to the latest version available based on the following timeline:

| Base Version Change | Time to include in release |
|---------------------|----------------------------|
| Patch version | Within 2 weeks |
| Minor version | Within 30 days |
| Major version | Before the previous version is EOL |


## Upstream CVE Disclosure

Replicated KOTS and kURL deliver many upstream Kubernetes and ecosystem components.
We don’t build these packages and rely on the upstream software vendor to distribute patches.
Our intent is to make any patches available as soon as possible, but guarantee the following timeline to make upstream patches available after we learn about the vulnerability and a patch is available to us:

| CVE Level | Time to release |
|-----------|-----------------|
| Critical | Within 2 weeks |
| High | Within 60 days |
| Medium | Within 90 days |
| Low | Best effort unless risk accepted |

## Known Disclosed Vulnerabilities in our On Premises Products

KOTS utilizes an older version of kustomize, 3.5.4, released in January 2020. We continue to include and use this version because newer versions, including v3.10.0 through v4.x, are 6x-12x slower which imparts an unacceptable delay when saving application config or applying updates in KOTS. However, v3.5.4 also contains a number of high or critical vulnerabilities. We’ve assessed each of these vulnerabilities for both relevance to KOTS as well as risk. 

| CVE | CVE Summary | Rationale | Additional Reading |
|-----|-------------|-----------|--------------------|
|CVE-2014-3499|Docker 1.0.0 uses world-readable and world-writable permissions on the management socket, which allows local users to gain privileges via unspecified vectors. |	If Docker is the CRI of choice, Docker 1.0.0 is unlikely to be in use. Alternatively, another CRI may be implemented as a compensating control.	| https://access.redhat.com/security/cve/CVE-2014-3499
CVE-2014-6407 |	Docker before 1.3.2 allows remote attackers to write to arbitrary files and execute arbitrary code via a (1) symlink or (2) hard link attack in an image archive in a (a) pull or (b) load operation. |	Exploitation requires a malicious image. KOTS utilizes trusted images directly supplied by the software vendor. |	https://access.redhat.com/security/cve/CVE-2014-6407#cve-cvss-v2
CVE-2014-9356	| It was found that a malicious container image could overwrite arbitrary portions of the host file system by including absolute symlinks, potentially leading to privilege escalation. |	Exploitation requires a malicious image. KOTS utilizes trusted images directly supplied by the software vendor.	| https://access.redhat.com/security/cve/cve-2014-9356
CVE-2014-9357 |	A flaw was found in the way the Docker service unpacked images or builds after a "docker pull". An attacker could use this flaw to provide a malicious image or build that, when unpacked, would escalate their privileges on the system. |	Exploitation requires a malicious image. KOTS utilizes trusted images directly supplied by the software vendor. |	https://access.redhat.com/security/cve/cve-2014-9357
CVE-2015-3627 |	Libcontainer and Docker Engine before 1.6.1 opens the file-descriptor passed to the pid-1 process before performing the chroot, which allows local users to gain privileges via a symlink attack in an image. |	Exploitation requires a malicious image. KOTS utilizes trusted images directly supplied by the software vendor. |	https://access.redhat.com/security/cve/cve-2015-3627
CVE-2022-27191 |	The golang.org/x/crypto/ssh package before 0.0.0-20220314234659-1baeb1ce4c0b for Go allows an attacker to crash a server in certain circumstances involving AddHostKey.	| KOTS does not utilize Go’s SSH package to create key pairs. |	https://access.redhat.com/security/cve/cve-2022-27191
CVE-2020-14040 | A denial of service vulnerability was found in the golang.org/x/text library. If an attacker supplies specific input there is the potential to cause an infinite loop to occur using more memory, resulting in a denial of service. |	KOTS does not accept generic user input, only Kubernetes manifests which are then passed to Kustomize. Additionally, there is never a direct interface to golang’s text library |	https://access.redhat.com/security/cve/cve-2020-14040 |

Based on this analysis, we feel these vulnerabilities do not meaningfully detract from KOTS overall security posture while still maintaining usability. We continue to performance test new versions of Kustomize to find a suitably performant and secure version. At this time, we are continuing to include v3.5.4, with the known vulnerabilities, until a better solution is available.
