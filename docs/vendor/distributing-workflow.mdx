import SDKOverview from "../partials/replicated-sdk/_overview.mdx"
import BestPractices from "../partials/onboarding/_best-practices.mdx"
import Community from "../partials/onboarding/_community.mdx"
import Prerequisites from "../partials/onboarding/_prerequisites.mdx"
import PackageSdk from "../partials/onboarding/_package-sdk.mdx"
import PreflightSupportBundle from "../partials/onboarding/_preflight-support-bundle.mdx"
import DependencyYaml from "../partials/replicated-sdk/_dependency-yaml.mdx"

# KOTS and Embedded Cluster Onboarding 

This topic describes how to onboard applications that will support installation with Replicated KOTS, Replicated Embedded Cluster, and the Helm CLI.

If your application will support Helm CLI installations only, see [Helm CLI-Only Onboarding](/vendor/replicated-onboarding).

## Before You Begin

This section includes guidance and prerequisites to review before you begin onboarding your application.

### Prerequisites

<Prerequisites/>

### Best Practices and Recommendations

<BestPractices/>

### Getting Help from the Community

<Community/>

## Onboard

### Step 0: Create An Application

Create an application in the Vendor Portal. See [Create an Application](/vendor/vendor-portal-manage-app#create-an-application).

### Step 0: Connect Your Image Registry

Add credentials for your image registry to the Vendor Portal. This will allow you to enable the Replicated proxy service in a later step so that you can grant proxy access to application images without exposing registry credentials to your customers.

For more information, see [Connecting to an External Registry](/vendor/packaging-private-images).

### Step 1: Create the Initial Release

As part of the initial release for your application, you will add your Helm chart archive, KOTS HelmChart custom resource, and Embedded Cluster Config to the release.

#### Step 1a: Package Your Helm Chart with the Replicated SDK

<PackageSdk/>

<DependencyYaml/>

#### Step 1b: Configure the KOTS HelmChart Custom Resource

The KOTS HelmChart custom resource is required to install Helm charts with KOTS and Embedded Cluster. It provides instructions to KOTS about how to deploy the given Helm chart.

To configure the KOTS HelmChart Custom Resource, complete the workflow in [Configuring the HelmChart Custom Resource](helm-native-v2-using).

:::note
If your application is deployed as multiple Helm charts, add a separate HelmChart custom resource for each chart.
:::

#### Step 1c: Add the Embedded Cluster Config

Create an Embedded Cluster Config to support installations on VMs or bare metal servers with the Replicated Embedded Cluster installer.

```yaml
apiVersion: embeddedcluster.replicated.com/v1beta1
kind: Config
spec:
  version: 1.8.0+k8s-1.29
```
See the Embedded Cluster GitHub repo to find the latest version.

For more information, see [Using Embedded Cluster](/vendor/embedded-overview).

### Step 2: Customize the KOTS Admin Console {#admin-console}

The following custom resources can be added to customize the Admin Console experience for your application and enable recommended features for KOTS.

#### Step 2a: Add Application Name, Icon, and Status Informers

For more information, see [Application](/reference/custom-resource-application).

Example:

```yaml
apiVersion: kots.io/v1beta1
kind: Application
metadata:
  name: gitea
spec:
  title: Gitea
  icon: https://raw.githubusercontent.com/cncf/artwork/master/projects/kubernetes/icon/color/kubernetes-icon-color.png
  statusInformers:
    - deployment/gitea
```

#### Step 2b: Add Application Links to the Dashboard

Replicated recommends that every application include a Kubernetes SIG Application custom resource to add application links to the Admin Console dashboard.

For more information, see [Adding Application Links to the Dashboard](/vendor/admin-console-adding-buttons-links).

```yaml
apiVersion: app.k8s.io/v1beta1
kind: Application
metadata:
  name: "gitea"
spec:
  descriptor:
    links:
      - description: Open App
        url: ""
```  

### Step 3: Set Up the Admin Console Config Screen

Create a configuration screen in the Admin Console to collect required and optional configuration values from your users.

<a href="/vendor/admin-console-customize-config-screen">Creating and Editing Configuration Fields</a>     

### Step 4: Configure Preflight Checks and Support Bundles

<PreflightSupportBundle/>

### Step 5: Configure Backup and Restore

Enable snapshots with Velero so that end users can back up and restore their application data.

* Snapshots for existing cluster KOTS installs. See <a href="snapshots-configuring-backups">Configuring Backup and Restore</a>
* Disaster recovery feature for Embedded Cluster installs

### Step 6: Add Custom Domains

You can use custom domains to alias Replicated endpoints by creating Canonical Name (CNAME) records for your domains.

Replicated domains are external to your domain and can require additional security reviews by your customer. Using custom domains as aliases can bring the domains inside an existing security review and reduce your exposure.

For more information, see [Using Custom Domains](/vendor/custom-domains-using).

### Step 9: Customize Customer Licenses

Add custom license entitlements, and use the SDK API to check entitlements in the customer environment.

* Add custom entitlements
* Add entitlement checks
* License field signature validation

## Next Steps

### Customize Release Channels

### Configure Advanced Features

* Custom metrics
* SDK API 
* 

### Integrate with CI/CD and Compatibility Matrix

Compatibility Matrix