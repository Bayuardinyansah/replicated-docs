import CreateReleaseUi from "../partials/releases/_create-release-ui.mdx"
import CreateNewAppCli from "../partials/releases/_create-new-app-cli.mdx"

# Creating Releases with Standard Manifest Files

This topic describes how to use the Replicated vendor portal or the replicated CLI to create and promote versions of your application using standard manifest files.

## Using the Vendor Portal

<CreateReleaseUi/>

## Using the CLI

### Prerequisite

Before you can create an application with the CLI for the first time, you must install the replicated CLI and create an API token. See [Installing the replicated CLI](/reference/replicated-cli-installing).

### Create an Application

<CreateNewAppCli/>

### Import Application Files

To create your first application release, first import the Kubernetes manifest files for the application.

:::note
For Kubernetes Operators, see [About Packaging Kubernetes Operators](operator-packaging-about).
:::

To get the sample manifest files:

1. Run the following command to create and change to a `replicated-cli-tutorial` directory:

  ```
  mkdir replicated-cli-tutorial
  cd replicated-cli-tutorial
  ```

1. Create a `/manifests` directory and download the sample manifest files from the [kots-default-yaml](https://github.com/replicatedhq/kots-default-yaml) repository in GitHub:

  ```
  mkdir ./manifests
  curl -fSsL https://github.com/replicatedhq/kots-default-yaml/archive/refs/heads/main.zip | \
    tar xzv --strip-components=1 -C ./manifests \
    --exclude README.md --exclude LICENSE --exclude .gitignore
  ```

1. Verify that you can see the YAML files in the `replicated-cli-tutorial/manifests` folder:

  ```
  ls manifests/
  ```
  ```
  example-configmap.yaml   example-service.yaml     kots-app.yaml            kots-lint-config.yaml    kots-support-bundle.yaml
  example-deployment.yaml  k8s-app.yaml             kots-config.yaml         kots-preflight.yaml
  ```

### Create and Promote a Release

1. (Recommended) Lint the manifest files and ensure that there are no errors in the YAML:

  ```bash
  replicated release lint --yaml-dir=YAML_DIR
  ```

  Replace YAML_DIR with the root directory of the YAML application manifest files.

1. Initialize the project as a Git repository. You only need to initialize a project once.

  **Example:**

  ```
  git init
  git add .
  git commit -m "Initial Commit: My Application"
  ```
  
  Initializing the project as a Git repository lets you track your history. The replicated CLI also reads Git metadata to help with the generation of release metadata, such as version labels.

1. Edit your files as needed, such as adding preflight specifications or other Replicated custom resources.

1. Lint the manifest files after you make changes to ensure that there are no errors in the YAML:

  ```bash
  replicated release lint --yaml-dir=YAML_DIR
  ```

  Replace YAML_DIR with the root directory of the YAML application manifest files.

1. From your application root directory, do one of the following:

    - Create a release with the default settings, which includes the Unstable channel:

      ```bash
      replicated release create --auto
      ```

      The `--auto` flag generates release notes and metadata based on the Git status. 
  
    - Create a release with custom settings:

      **Example:**

      ```bash
      replicated release create --yaml-dir YAML_DIR --promote CHANNEL
      ```

      Replace:

      - YAML_DIR with the root directory of the YAML application manifest files.
      - CHANNEL with the name of the channel that you want to promote to. Channel names are case sensitive.
    
      For more information about flag options, see [release create](/reference/replicated-cli-release-create) in _Reference_.

    **Example output:**

    ```
        • Reading Environment ✓

      Prepared to create release with defaults:

          yaml-dir        "./manifests"
          promote         "Unstable"
          version         "Unstable-ba710e5"
          release-notes   "CLI release of master triggered by exampleusername [SHA: d4173a4] [31 Oct 22 08:51 MDT]"
          ensure-channel  true
          lint-release    true

      Create with these properties? [Y/n]
    ```

1. Type `y` and press **Enter** to confirm the prompt.

  **Example output:**

  ```text
    • Reading manifests from ./manifests ✓
    • Creating Release ✓
      • SEQUENCE: 1
    • Promoting ✓
      • Channel VEr0nhJBBUdaWpPvOIK-SOryKZEwa3Mg successfully set to release 1
  ```
  The release is created and promoted to the specified or default channel.

1. Verify that the release was promoted to the channel:

  ```
  replicated release ls
  ```
  
## Next Steps

The following are the recommended next steps to test the application in your development environment:

- To add a customer, see [Creating a Customer](creating-a-customer).
- If you are installing for the first time, see [Overview of Installing an Application with the App Manager](/enterprise/installing-overview) in the _Enterprise_ section. 
- If you are updating an existing installation, see [Updating an Application](../enterprise/updating-apps) in the _Enterprise_ section.

## Related Topics

* [About Releases](releases-about)
* [About Release Channels](releases-about-channels)
* [How to Package and Distribute a Production Application](distributing-workflow)
